@hostname = localhost
@port = 5525
@host = http://{{hostname}}:{{port}}
@contentType = application/json

# Setup
@email = tester_{{$timestamp}}@gameservice.com
@password = Test123!ABC

### 1. Health Check
GET {{host}}/health

### 2. Register User
POST {{host}}/auth/register
Content-Type: {{contentType}}

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### 3. Login
POST {{host}}/auth/login
Content-Type: {{contentType}}

{
  "email": "{{email}}",
  "password": "{{password}}"
}

> {%
    client.global.set("auth_token", response.body.accessToken);
    client.log("ðŸ” Token stored: " + response.body.accessToken);
%}

### 4. Get Profile (Initial Create)
GET {{host}}/game/me
Authorization: Bearer {{auth_token}}

> {%
    client.test("Status OK", function () {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("starting_coins", response.body.coins);
%}

### 5. Earn Coins
POST {{host}}/game/coins/transaction
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

{
  "amount": 50
}

> {%
    client.test("Balance Updated", function () {
        client.assert(response.body.newBalance > client.global.get("starting_coins"), "Balance did not increase");
    });
%}

### 6. Security Check: Negative Overflow
POST {{host}}/game/coins/transaction
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

{
  "amount": -999999
}

> {%
    client.test("Rejected Insufficient Funds", function () {
        client.assert(response.status === 400, "Should return Bad Request");
    });
%}